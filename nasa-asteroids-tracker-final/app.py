# Streamlit app code you provided (too large to paste again)
# We'll assume it's written here correctly
